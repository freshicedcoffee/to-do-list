<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TokaTask</title>
  <meta name="theme-color" content="#14b8a6" />
  <meta name="description" content="Your productivity companion - Get things done with style" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Crect width='100' height='100' rx='20' fill='%2314b8a6'/%3E%3Cpath d='M75 30 L42 63 L25 46' stroke='white' stroke-width='8' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style> 
    body { margin: 0; font-family: system-ui, -apple-system, sans-serif; } 
    .dragging { opacity: 0.5; transform: scale(0.98); transition: all 0.2s; }
    .drag-over { border-top: 3px solid #14b8a6; transform: translateY(-2px); }
    
    @keyframes slide-up {
      from { transform: translateX(-50%) translateY(100px); opacity: 0; }
      to { transform: translateX(-50%) translateY(0); opacity: 1; }
    }
    .animate-slide-up { animation: slide-up 0.3s ease-out; }
    
    @keyframes fade-in {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-in { animation: fade-in 0.4s ease-out; }
    
    @keyframes scale-in {
      from { transform: scale(0.9); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .scale-in { animation: scale-in 0.3s ease-out; }
    
    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }
    
    .checkbox-bounce {
      transition: all 0.2s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    
    .checkbox-bounce:active {
      transform: scale(0.9);
    }
    
    .hover-lift {
      transition: all 0.2s ease;
    }
    
    .hover-lift:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .task-item {
      transition: all 0.3s ease;
    }
    
    .task-item:hover {
      transform: translateX(4px);
    }
    
    .gradient-bg {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .gradient-bg-teal {
      background: linear-gradient(135deg, #0f766e 0%, #14b8a6 50%, #2dd4bf 100%);
    }
    
    .glass-effect {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .dark .glass-effect {
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Help modal specific */
    .help-backdrop {
      backdrop-filter: blur(6px);
      background: rgba(0,0,0,0.35);
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAvOX-RWiwyOfJKwWeEZMC4Yca1grklMJs",
      authDomain: "todolist-6dd72.firebaseapp.com",
      projectId: "todolist-6dd72",
      storageBucket: "todolist-6dd72.firebasestorage.app",
      messagingSenderId: "6906407441",
      appId: "1:6906407441:web:ff6f8463af810fe3189fb0",
      measurementId: "G-K9LMMSZKVS"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const firestore = firebase.firestore();
    firestore.enablePersistence().catch(err => {});

    const { useState, useEffect, useRef } = React;

    function Icon(tagName, props, ...children) {
      return React.createElement(tagName, props, ...children);
    }
    function Plus(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("line",{x1:12,y1:5,x2:12,y2:19}), Icon("line",{x1:5,y1:12,x2:19,y2:12})); }
    function Check(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("polyline",{points:"20 6 9 17 4 12"})); }
    function Trash2(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("polyline",{points:"3 6 5 6 21 6"}), Icon("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}), Icon("line",{x1:10,y1:11,x2:10,y2:17}), Icon("line",{x1:14,y1:11,x2:14,y2:17})); }
    function Edit2(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})); }
    function X(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("line",{x1:18,y1:6,x2:6,y2:18}), Icon("line",{x1:6,y1:6,x2:18,y2:18})); }
    function AlertCircle(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("circle",{cx:12,cy:12,r:10}), Icon("line",{x1:12,y1:8,x2:12,y2:12}), Icon("line",{x1:12,y1:16,x2:12.01,y2:16})); }
    function Calendar(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("rect",{x:3,y:4,width:18,height:18,rx:2,ry:2}), Icon("line",{x1:16,y1:2,x2:16,y2:6}), Icon("line",{x1:8,y1:2,x2:8,y2:6}), Icon("line",{x1:3,y1:10,x2:21,y2:10})); }
    function Tag(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"}), Icon("line",{x1:7,y1:7,x2:7.01,y2:7})); }
    function Sun(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("circle",{cx:12,cy:12,r:5}), Icon("line",{x1:12,y1:1,x2:12,y2:3}), Icon("line",{x1:12,y1:21,x2:12,y2:23}), Icon("line",{x1:4.22,y1:4.22,x2:5.64,y2:5.64}), Icon("line",{x1:18.36,y1:18.36,x2:19.78,y2:19.78}), Icon("line",{x1:1,y1:12,x2:3,y2:12}), Icon("line",{x1:21,y1:12,x2:23,y2:12}), Icon("line",{x1:4.22,y1:19.78,x2:5.64,y2:18.36}), Icon("line",{x1:18.36,y1:5.64,x2:19.78,y2:4.22})); }
    function Moon(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})); }
    function Settings(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("circle",{cx:12,cy:12,r:3}), Icon("path",{d:"M12 1v6m0 6v6m8.66-9l-5.2 3M8.54 14l-5.2 3m13.32 0l-5.2-3M8.54 10l-5.2-3"})); }
    function GripVertical(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("circle",{cx:9,cy:12,r:1}), Icon("circle",{cx:9,cy:5,r:1}), Icon("circle",{cx:9,cy:19,r:1}), Icon("circle",{cx:15,cy:12,r:1}), Icon("circle",{cx:15,cy:5,r:1}), Icon("circle",{cx:15,cy:19,r:1})); }
    function List(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("line",{x1:8,y1:6,x2:21,y2:6}), Icon("line",{x1:8,y1:12,x2:21,y2:12}), Icon("line",{x1:8,y1:18,x2:21,y2:18}), Icon("line",{x1:3,y1:6,x2:3.01,y2:6}), Icon("line",{x1:3,y1:12,x2:3.01,y2:12}), Icon("line",{x1:3,y1:18,x2:3.01,y2:18})); }
    function CalendarIcon(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("rect",{x:3,y:4,width:18,height:18,rx:2,ry:2}), Icon("line",{x1:16,y1:2,x2:16,y2:6}), Icon("line",{x1:8,y1:2,x2:8,y2:6}), Icon("line",{x1:3,y1:10,x2:21,y2:10})); }
    function ChevronLeft(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("polyline",{points:"15 18 9 12 15 6"})); }
    function ChevronRight(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("polyline",{points:"9 18 15 12 9 6"})); }
    function Mic(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("path",{d:"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"}), Icon("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}), Icon("line",{x1:12,y1:19,x2:12,y2:23}), Icon("line",{x1:8,y1:23,x2:16,y2:23})); }
    function Volume2(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5"}), Icon("path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14M15.54 8.46a5 5 0 0 1 0 7.07"})); }
    function HelpCircle(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("circle",{cx:12,cy:12,r:10}), Icon("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}), Icon("line",{x1:12,y1:17,x2:12.01,y2:17})); }
    function Search(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("circle",{cx:11,cy:11,r:8}), Icon("line",{x1:21,y1:21,x2:16.65,y2:16.65})); }
    function LogOut(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}), Icon("polyline",{points:"16 17 21 12 16 7"}), Icon("line",{x1:21,y1:12,x2:9,y2:12})); }
    function Filter(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"})); }
    function ArrowUpDown(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("path",{d:"m21 16-4 4-4-4"}), Icon("path",{d:"M17 20V4"}), Icon("path",{d:"m3 8 4-4 4 4"}), Icon("path",{d:"M7 4v16"})); }
    function Repeat(p){ return Icon("svg",{width:p.size||20,height:p.size||20,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2}, Icon("polyline",{points:"17 1 21 5 17 9"}), Icon("path",{d:"M3 11V9a4 4 0 0 1 4-4h14"}), Icon("polyline",{points:"7 23 3 19 7 15"}), Icon("path",{d:"M21 13v2a4 4 0 0 1-4 4H3"})); }

    const formatDate = (d) => {
      if(!d) return null;
      try { return new Date(d).toLocaleDateString(); } catch(e){ return d; }
    };

    function App(){
      const [user, setUser] = useState(null);
      const [initializing, setInitializing] = useState(true);
      const [darkMode, setDarkMode] = useState(() => {
        const saved = window.darkModePreference;
        if (saved !== undefined) return saved;
        return window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
      });

      useEffect(() => {
        window.darkModePreference = darkMode;
      }, [darkMode]);

      useEffect(() => {
        const unsub = auth.onAuthStateChanged(u => {
          setUser(u);
          setInitializing(false);
        });
        return () => unsub();
      }, []);

      if(initializing) {
        return React.createElement("div",{className:`min-h-screen flex items-center justify-center ${darkMode ? 'bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900' : 'bg-gradient-to-br from-teal-50 via-white to-emerald-50'}`}, 
          React.createElement("div",{className:"text-center scale-in"},
            React.createElement("div",{className:`inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid ${darkMode ? 'border-teal-500 border-r-transparent' : 'border-teal-600 border-r-transparent'}`}),
            React.createElement("p",{className:`mt-4 ${darkMode ? 'text-gray-300' : 'text-gray-600'} font-medium`},"Loading...")
          )
        );
      }

      return user ? React.createElement(TodoApp,{user, darkMode, setDarkMode}) : React.createElement(AuthView,{darkMode, setDarkMode});
    }

    function AuthView({darkMode, setDarkMode}){
      const [mode, setMode] = useState('login');
      const [email, setEmail] = useState('');
      const [password, setPassword] = useState('');
      const [loading, setLoading] = useState(false);
      const [error, setError] = useState('');

      const handleAuth = async () => {
        setLoading(true);
        setError('');
        try {
          if(mode === 'login') {
            await auth.signInWithEmailAndPassword(email, password);
          } else {
            await auth.createUserWithEmailAndPassword(email, password);
          }
        } catch(err) {
          setError(err.message);
        }
        setLoading(false);
      };

      const googleSignIn = async () => {
        setError('');
        const provider = new firebase.auth.GoogleAuthProvider();
        try {
          await auth.signInWithPopup(provider);
        } catch(err){
          setError(err.message || 'Google sign-in failed');
        }
      };

      return React.createElement("div",{className:`min-h-screen flex items-center justify-center p-4 ${darkMode ? 'bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900' : 'bg-gradient-to-br from-teal-50 via-white to-emerald-50'}`},
        React.createElement("div",{className:"absolute top-4 right-4"},
          React.createElement("button",{onClick:()=>setDarkMode(!darkMode),className:`p-3 rounded-full transition-all duration-300 hover-lift ${darkMode ? 'bg-gray-800 text-yellow-400 hover:bg-gray-700' : 'bg-white text-gray-700 hover:bg-gray-50 shadow-lg'}`},
            darkMode ? React.createElement(Sun,{size:20}) : React.createElement(Moon,{size:20})
          )
        ),
        React.createElement("div",{className:`w-full max-w-md fade-in`},
          React.createElement("div",{className:`${darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white'} rounded-3xl shadow-2xl p-8 hover-lift`},
            React.createElement("div",{className:"text-center mb-8"},
              React.createElement("div",{className:`w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center gradient-bg-teal shadow-lg`},
                React.createElement(Check,{size:32,className:"text-white"})
              ),
              React.createElement("h1",{className:`text-3xl font-bold mb-2 ${darkMode ? 'text-white' : 'text-gray-900'}`},"TokaTask"),
              React.createElement("p",{className:`${darkMode ? 'text-gray-400' : 'text-gray-600'}`},"Your productivity companion")
            ),

            React.createElement("div",{className:"space-y-4 mb-6"},
              React.createElement("input",{type:"email",value:email,onChange:e=>setEmail(e.target.value),onKeyDown:e=>{ if(e.key==='Enter') handleAuth(); },placeholder:"Email",className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500 focus:bg-white'}`}),
              React.createElement("input",{type:"password",value:password,onChange:e=>setPassword(e.target.value),onKeyDown:e=>{ if(e.key==='Enter') handleAuth(); },placeholder:"Password",className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500 focus:bg-white'}`})
            ),

            error && React.createElement("div",{className:`mb-4 p-3 rounded-xl flex items-center gap-2 ${darkMode ? 'bg-red-900/30 border border-red-700 text-red-300' : 'bg-red-50 border border-red-200 text-red-700'}`},
              React.createElement(AlertCircle,{size:20}),
              React.createElement("span",{className:"text-sm"},error)
            ),

            React.createElement("button",{onClick:handleAuth,disabled:loading,className:`w-full py-3 rounded-xl font-semibold transition-all duration-300 hover-lift ${loading ? 'opacity-50 cursor-not-allowed' : ''} gradient-bg-teal text-white shadow-lg hover:shadow-xl`},
              loading ? "Processing..." : mode === 'login' ? "Sign In" : "Create Account"
            ),

            React.createElement("div",{className:"mt-6 mb-6 flex items-center gap-3"},
              React.createElement("div",{className:`flex-1 h-px ${darkMode ? 'bg-gray-700' : 'bg-gray-300'}`}),
              React.createElement("span",{className:`text-sm ${darkMode ? 'text-gray-500' : 'text-gray-400'}`},"or"),
              React.createElement("div",{className:`flex-1 h-px ${darkMode ? 'bg-gray-700' : 'bg-gray-300'}`})
            ),

            React.createElement("button",{onClick:googleSignIn,className:`w-full py-3 rounded-xl font-medium transition-all duration-300 hover-lift flex items-center justify-center gap-3 ${darkMode ? 'bg-gray-700 border-2 border-gray-600 text-white hover:bg-gray-650' : 'bg-white border-2 border-gray-300 text-gray-700 hover:bg-gray-50'} shadow-lg`}, 
              React.createElement("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg", style:{width:20,height:20}}),
              "Continue with Google"
            ),

            React.createElement("div",{className:"mt-6 text-center"},
              React.createElement("button",{onClick:()=>setMode(mode === 'login' ? 'signup' : 'login'),className:`text-sm ${darkMode ? 'text-teal-400 hover:text-teal-300' : 'text-teal-600 hover:text-teal-700'} transition-colors`},
                mode === 'login' ? "Need an account? Sign up" : "Already have an account? Sign in"
              )
            )
          )
        )
      );
    }

    function TodoApp({user, darkMode, setDarkMode}){
      const [todos, setTodos] = useState([]);
      const [text, setText] = useState('');
      const [category, setCategory] = useState('Personal');
      const [dueDate, setDueDate] = useState('');
      const [notes, setNotes] = useState('');
      const [recurrence, setRecurrence] = useState('none');
      const [priority, setPriority] = useState('medium');
      const [filter, setFilter] = useState('all');
      const [sortBy, setSortBy] = useState('createdAt');
      const [searchTerm, setSearchTerm] = useState('');
      const [selectedCategory, setSelectedCategory] = useState('all');
      const [editingId, setEditingId] = useState(null);
      const [editText, setEditText] = useState('');
      const [editNotes, setEditNotes] = useState('');
      // NEW: Additional edit state for category, due date, priority, and recurrence
      const [editCategory, setEditCategory] = useState('');
      const [editDueDate, setEditDueDate] = useState('');
      const [editPriority, setEditPriority] = useState('');
      const [editRecurrence, setEditRecurrence] = useState('');
      
      const [expandedNotes, setExpandedNotes] = useState({});
      const [showCategoryModal, setShowCategoryModal] = useState(false);
      const [customCategories, setCustomCategories] = useState([]);
      const [newCategory, setNewCategory] = useState('');
      const [draggedId, setDraggedId] = useState(null);
      const [dragOverId, setDragOverId] = useState(null);
      const [showToast, setShowToast] = useState(false);
      const [deletedTask, setDeletedTask] = useState(null);
      const [showAddTask, setShowAddTask] = useState(false);

      // NEW: Voice recording state
      const [isRecording, setIsRecording] = useState(false);
      const [audioBlob, setAudioBlob] = useState(null);
      const [audioUrl, setAudioUrl] = useState('');
      const mediaRecorderRef = useRef(null);
      const audioChunksRef = useRef([]);

      // NEW: help modal state
      const [showHelpModal, setShowHelpModal] = useState(false);

      const defaultCategories = ['Personal', 'Work', 'Shopping'];

      const motivationalQuotes = [
        { quote: "The secret of getting ahead is getting started.", author: "Mark Twain" },
        { quote: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
        { quote: "The future depends on what you do today.", author: "Mahatma Gandhi" },
        { quote: "You don't have to be great to start, but you have to start to be great.", author: "Zig Ziglar" },
        { quote: "Success is the sum of small efforts repeated day in and day out.", author: "Robert Collier" },
        { quote: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
        { quote: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
        { quote: "It always seems impossible until it's done.", author: "Nelson Mandela" },
        { quote: "Start where you are. Use what you have. Do what you can.", author: "Arthur Ashe" },
        { quote: "The harder you work for something, the greater you'll feel when you achieve it.", author: "Anonymous" },
        { quote: "Dream bigger. Do bigger.", author: "Anonymous" },
        { quote: "Don't stop when you're tired. Stop when you're done.", author: "Anonymous" },
        { quote: "Wake up with determination. Go to bed with satisfaction.", author: "Anonymous" },
        { quote: "Do something today that your future self will thank you for.", author: "Sean Patrick Flanery" },
        { quote: "Little things make big days.", author: "Anonymous" },
        { quote: "It's going to be hard, but hard does not mean impossible.", author: "Anonymous" },
        { quote: "Don't wait for opportunity. Create it.", author: "Anonymous" },
        { quote: "Sometimes we're tested not to show our weaknesses, but to discover our strengths.", author: "Anonymous" },
        { quote: "The key to success is to focus on goals, not obstacles.", author: "Anonymous" },
        { quote: "Dream it. Wish it. Do it.", author: "Anonymous" },
        { quote: "Success doesn't just find you. You have to go out and get it.", author: "Anonymous" },
        { quote: "Great things never come from comfort zones.", author: "Anonymous" },
        { quote: "Dream it. Believe it. Build it.", author: "Anonymous" },
        { quote: "Your limitation—it's only your imagination.", author: "Anonymous" },
        { quote: "Push yourself, because no one else is going to do it for you.", author: "Anonymous" },
        { quote: "Sometimes later becomes never. Do it now.", author: "Anonymous" },
        { quote: "The difference between ordinary and extraordinary is that little extra.", author: "Jimmy Johnson" },
        { quote: "You are never too old to set another goal or to dream a new dream.", author: "C.S. Lewis" },
        { quote: "Try to be a rainbow in someone's cloud.", author: "Maya Angelou" },
        { quote: "You are braver than you believe, stronger than you seem, and smarter than you think.", author: "A.A. Milne" }
      ];

      // Get quote based on day of year for daily rotation
      const getDailyQuote = () => {
        const now = new Date();
        const start = new Date(now.getFullYear(), 0, 0);
        const diff = now - start;
        const oneDay = 1000 * 60 * 60 * 24;
        const dayOfYear = Math.floor(diff / oneDay);
        return motivationalQuotes[dayOfYear % motivationalQuotes.length];
      };

      const dailyQuote = getDailyQuote();

      // NEW: Drag and drop handlers
      const handleDragStart = (e, id) => {
        setDraggedId(id);
        e.dataTransfer.effectAllowed = 'move';
      };

      const handleDragOver = (e, id) => {
        e.preventDefault();
        e.dataTransfer.dropEffect = 'move';
        if (id !== draggedId) {
          setDragOverId(id);
        }
      };

      const handleDragLeave = () => {
        setDragOverId(null);
      };

      const handleDrop = async (e, dropTargetId) => {
        e.preventDefault();
        setDragOverId(null);
        
        if (!draggedId || draggedId === dropTargetId) {
          setDraggedId(null);
          return;
        }

        // Find the dragged and target items
        const draggedIndex = sortedTodos.findIndex(t => t.id === draggedId);
        const targetIndex = sortedTodos.findIndex(t => t.id === dropTargetId);

        if (draggedIndex === -1 || targetIndex === -1) {
          setDraggedId(null);
          return;
        }

        // Reorder the array
        const newTodos = [...sortedTodos];
        const [draggedItem] = newTodos.splice(draggedIndex, 1);
        newTodos.splice(targetIndex, 0, draggedItem);

        // Update order field in Firestore for each affected item
        try {
          const batch = firestore.batch();
          newTodos.forEach((todo, index) => {
            const docRef = firestore.collection('todos').doc(todo.id);
            batch.update(docRef, { order: index });
          });
          await batch.commit();
        } catch(err) {
          console.error('Error updating order:', err);
        }

        setDraggedId(null);
      };

      const handleDragEnd = () => {
        setDraggedId(null);
        setDragOverId(null);
      };

      // NEW: Voice recording functions
      const startRecording = async () => {
        try {
          const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
          
          // Try to use a compatible format
          let options = { mimeType: 'audio/webm' };
          if (!MediaRecorder.isTypeSupported('audio/webm')) {
            options = { mimeType: 'audio/mp4' };
            if (!MediaRecorder.isTypeSupported('audio/mp4')) {
              options = {}; // Use default
            }
          }
          
          mediaRecorderRef.current = new MediaRecorder(stream, options);
          audioChunksRef.current = [];

          mediaRecorderRef.current.ondataavailable = (event) => {
            if (event.data.size > 0) {
              audioChunksRef.current.push(event.data);
            }
          };

          mediaRecorderRef.current.onstop = () => {
            const mimeType = mediaRecorderRef.current.mimeType || 'audio/webm';
            const audioBlob = new Blob(audioChunksRef.current, { type: mimeType });
            const audioUrl = URL.createObjectURL(audioBlob);
            setAudioBlob(audioBlob);
            setAudioUrl(audioUrl);
            
            // Stop all tracks to release microphone
            stream.getTracks().forEach(track => track.stop());
          };

          mediaRecorderRef.current.onerror = (event) => {
            console.error('MediaRecorder error:', event.error);
            alert('Recording error: ' + event.error);
            stream.getTracks().forEach(track => track.stop());
            setIsRecording(false);
          };

          mediaRecorderRef.current.start();
          setIsRecording(true);
        } catch (err) {
          console.error('Error accessing microphone:', err);
          alert('Could not access microphone. Please check permissions.');
        }
      };

      const stopRecording = () => {
        if (mediaRecorderRef.current && isRecording) {
          mediaRecorderRef.current.stop();
          setIsRecording(false);
        }
      };

      const clearRecording = () => {
        if (audioUrl) {
          URL.revokeObjectURL(audioUrl);
        }
        setAudioBlob(null);
        setAudioUrl('');
      };

      useEffect(() => {
        if(!user) return;
        const unsub = firestore.collection('todos').where('userId','==',user.uid).onSnapshot(snap => {
          const arr = snap.docs.map(d => ({id:d.id, ...d.data()}));
          setTodos(arr);
        });
        return () => unsub();
      }, [user]);

      useEffect(() => {
        if(!user) return;
        const unsub = firestore.collection('categories').doc(user.uid).onSnapshot(doc => {
          if(doc.exists) {
            setCustomCategories(doc.data().categories || []);
          }
        });
        return () => unsub();
      }, [user]);

      const addTodo = async () => {
        if(!text.trim() && !audioBlob) return;
        
        try {
          let audioData = null;
          if (audioBlob) {
            // Convert audio blob to base64 for storage
            audioData = await new Promise((resolve, reject) => {
              const reader = new FileReader();
              reader.onloadend = () => resolve(reader.result);
              reader.onerror = reject;
              reader.readAsDataURL(audioBlob);
            });
          }
          
          // Get the highest order value and add 1
          const maxOrder = todos.length > 0 ? Math.max(...todos.map(t => t.order || 0)) : -1;
          
          const todo = {
            text: text.trim() || '🎤 Voice Memo',
            completed: false,
            userId: user.uid,
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            category: category || 'Personal',
            dueDate: dueDate || null,
            notes: notes.trim() || null,
            recurrence: recurrence || 'none',
            priority: priority || 'medium',
            audioData: audioData,
            order: maxOrder + 1
          };
          await firestore.collection('todos').add(todo);
          setText('');
          setCategory('Personal');
          setDueDate('');
          setNotes('');
          setRecurrence('none');
          setPriority('medium');
          clearRecording();
          setShowAddTask(false);
        } catch(err) {
          console.error('Error adding task:', err);
          alert('Failed to add task: ' + err.message);
        }
      };

      const toggleTodo = async (id, completed, rec) => {
        const task = todos.find(t => t.id === id);
        if(!task || task.userId !== user.uid) {
          console.error('Cannot toggle task that belongs to another user');
          return;
        }
        
        try {
          await firestore.collection('todos').doc(id).update({completed: !completed});
          if(!completed && rec && rec !== 'none') {
            const todo = todos.find(t => t.id === id);
            if(todo && todo.dueDate) {
              let nextDate = new Date(todo.dueDate.seconds ? todo.dueDate.seconds * 1000 : todo.dueDate);
              if(rec === 'daily') nextDate.setDate(nextDate.getDate() + 1);
              else if(rec === 'weekly') nextDate.setDate(nextDate.getDate() + 7);
              else if(rec === 'monthly') nextDate.setMonth(nextDate.getMonth() + 1);
              await firestore.collection('todos').add({
                text: todo.text,
                completed: false,
                userId: user.uid,
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                category: todo.category,
                dueDate: nextDate.toISOString(),
                notes: todo.notes,
                recurrence: todo.recurrence,
                priority: todo.priority
              });
            }
          }
        } catch(err) {
          console.error('Error toggling task:', err);
          alert('Failed to update task: ' + err.message);
        }
      };

      const deleteTodo = async (id) => {
        const task = todos.find(t => t.id === id);
        if(!task) return;
        
        // Check if this task belongs to the current user
        if(task.userId !== user.uid) {
          console.error('Cannot delete task that belongs to another user');
          return;
        }
        
        setDeletedTask({...task, id});
        try {
          await firestore.collection('todos').doc(id).delete();
          setShowToast(true);
          setTimeout(() => setShowToast(false), 5000);
        } catch(err) {
          console.error('Error deleting task:', err);
          alert('Failed to delete task: ' + err.message);
          setDeletedTask(null);
        }
      };

      const undoDelete = async () => {
        if(!deletedTask) return;
        const {id, ...taskData} = deletedTask;
        await firestore.collection('todos').add(taskData);
        setShowToast(false);
        setDeletedTask(null);
      };

      // UPDATED: Enhanced startEdit to include all task properties
      const startEdit = (id, currentText, currentNotes, currentCategory, currentDueDate, currentPriority, currentRecurrence) => {
        setEditingId(id);
        setEditText(currentText);
        setEditNotes(currentNotes || '');
        setEditCategory(currentCategory || 'Personal');
        setEditPriority(currentPriority || 'medium');
        setEditRecurrence(currentRecurrence || 'none');
        
        // Format due date for input field
        if(currentDueDate) {
          let dateStr;
          if(currentDueDate.seconds) {
            dateStr = new Date(currentDueDate.seconds * 1000).toISOString().split('T')[0];
          } else if(typeof currentDueDate === 'string') {
            dateStr = new Date(currentDueDate).toISOString().split('T')[0];
          } else {
            dateStr = '';
          }
          setEditDueDate(dateStr);
        } else {
          setEditDueDate('');
        }
      };

      // UPDATED: Enhanced saveEdit to save all fields
      const saveEdit = async (id) => {
        if(editText.trim()) {
          const task = todos.find(t => t.id === id);
          if(!task || task.userId !== user.uid) {
            console.error('Cannot edit task that belongs to another user');
            setEditingId(null);
            setEditText('');
            setEditNotes('');
            setEditCategory('');
            setEditDueDate('');
            setEditPriority('');
            setEditRecurrence('');
            return;
          }
          
          try {
            await firestore.collection('todos').doc(id).update({
              text: editText.trim(),
              notes: editNotes.trim() || null,
              category: editCategory || 'Personal',
              dueDate: editDueDate || null,
              priority: editPriority || 'medium',
              recurrence: editRecurrence || 'none'
            });
          } catch(err) {
            console.error('Error updating task:', err);
            alert('Failed to update task: ' + err.message);
          }
        }
        setEditingId(null);
        setEditText('');
        setEditNotes('');
        setEditCategory('');
        setEditDueDate('');
        setEditPriority('');
        setEditRecurrence('');
      };

      const toggleNotes = (id) => {
        setExpandedNotes(prev => ({...prev, [id]: !prev[id]}));
      };

      const addCustomCategory = async () => {
        if(!newCategory.trim()) return;
        const updated = [...customCategories, newCategory.trim()];
        await firestore.collection('categories').doc(user.uid).set({categories: updated});
        setNewCategory('');
      };

      const deleteCustomCategory = async (cat) => {
        const updated = customCategories.filter(c => c !== cat);
        await firestore.collection('categories').doc(user.uid).set({categories: updated});
      };

      const clearAllTasks = async () => {
        if(!confirm('⚠️ Are you sure you want to delete ALL tasks? This action cannot be undone!')) {
          return;
        }
        
        try {
          const batch = firestore.batch();
          todos.forEach(todo => {
            const docRef = firestore.collection('todos').doc(todo.id);
            batch.delete(docRef);
          });
          await batch.commit();
          alert('All tasks have been deleted.');
        } catch(err) {
          console.error('Error clearing all tasks:', err);
          alert('Failed to clear tasks: ' + err.message);
        }
      };

      const clearCompletedTasks = async () => {
        const completedTasks = todos.filter(t => t.completed);
        if(completedTasks.length === 0) {
          alert('No completed tasks to clear.');
          return;
        }
        
        if(!confirm(`⚠️ Are you sure you want to delete ${completedTasks.length} completed task(s)? This action cannot be undone!`)) {
          return;
        }
        
        try {
          const batch = firestore.batch();
          completedTasks.forEach(todo => {
            const docRef = firestore.collection('todos').doc(todo.id);
            batch.delete(docRef);
          });
          await batch.commit();
          alert(`${completedTasks.length} completed task(s) have been deleted.`);
        } catch(err) {
          console.error('Error clearing completed tasks:', err);
          alert('Failed to clear completed tasks: ' + err.message);
        }
      };

      const allCategories = [...defaultCategories, ...customCategories];

      const filteredTodos = todos.filter(todo => {
        if(filter === 'active' && todo.completed) return false;
        if(filter === 'completed' && !todo.completed) return false;
        if(selectedCategory !== 'all' && todo.category !== selectedCategory) return false;
        if(searchTerm && !todo.text.toLowerCase().includes(searchTerm.toLowerCase())) return false;
        return true;
      });

      const sortedTodos = [...filteredTodos].sort((a,b) => {
        if(sortBy === 'createdAt') {
          // When sorting by created date, use order field if available for manual sorting
          if (a.order !== undefined && b.order !== undefined) {
            return a.order - b.order;
          }
          const aTime = a.createdAt?.seconds || 0;
          const bTime = b.createdAt?.seconds || 0;
          return bTime - aTime;
        }
        if(sortBy === 'dueDate') {
          if(!a.dueDate && !b.dueDate) return 0;
          if(!a.dueDate) return 1;
          if(!b.dueDate) return -1;
          const aDate = a.dueDate.seconds ? a.dueDate.seconds * 1000 : new Date(a.dueDate).getTime();
          const bDate = b.dueDate.seconds ? b.dueDate.seconds * 1000 : new Date(b.dueDate).getTime();
          return aDate - bDate;
        }
        if(sortBy === 'priority') {
          const priorityOrder = {high: 0, medium: 1, low: 2};
          return priorityOrder[a.priority || 'medium'] - priorityOrder[b.priority || 'medium'];
        }
        return 0;
      });

      const activeTasks = todos.filter(t => !t.completed).length;
      const completedTasks = todos.filter(t => t.completed).length;

      return React.createElement("div",{className:`min-h-screen ${darkMode ? 'bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900' : 'bg-gradient-to-br from-teal-50 via-white to-emerald-50'}`},
        React.createElement("div",{className:"max-w-5xl mx-auto p-4 md:p-8"},
          React.createElement("div",{className:"mb-8 fade-in"},
            React.createElement("div",{className:"flex items-center justify-between mb-4"},
              React.createElement("div",{className:"flex items-center gap-4"},
                React.createElement("div",{className:`w-14 h-14 rounded-2xl flex items-center justify-center gradient-bg-teal shadow-lg`},
                  React.createElement(Check,{size:28,className:"text-white"})
                ),
                React.createElement("div",null,
                  React.createElement("h1",{className:`text-4xl font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`},"TokaTask"),
                  // React.createElement("p",{className:`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'}`}, `${activeTasks} active · ${completedTasks} completed`)
                )
              ),
              React.createElement("div",{className:"flex items-center gap-2"},
                React.createElement("button",{onClick:()=>setShowHelpModal(true),className:`p-3 rounded-xl transition-all duration-300 hover-lift ${darkMode ? 'bg-gray-800 text-teal-400 hover:bg-gray-700' : 'bg-white text-teal-600 hover:bg-teal-50 shadow-lg'}`},
                  React.createElement(HelpCircle,{size:20})
                ),
                React.createElement("button",{onClick:()=>setDarkMode(!darkMode),className:`p-3 rounded-xl transition-all duration-300 hover-lift ${darkMode ? 'bg-gray-800 text-yellow-400 hover:bg-gray-700' : 'bg-white text-gray-700 hover:bg-gray-50 shadow-lg'}`},
                  darkMode ? React.createElement(Sun,{size:20}) : React.createElement(Moon,{size:20})
                ),
                React.createElement("button",{onClick:()=>auth.signOut(),className:`p-3 rounded-xl transition-all duration-300 hover-lift ${darkMode ? 'bg-gray-800 text-red-400 hover:bg-gray-700' : 'bg-white text-red-600 hover:bg-red-50 shadow-lg'}`},
                  React.createElement(LogOut,{size:20})
                )
              )
            ),
            
            React.createElement("div",{className:`${darkMode ? 'bg-gray-800/50 border border-gray-700' : 'bg-white/80 border border-teal-100'} rounded-2xl p-6 shadow-lg backdrop-blur-sm`},
              React.createElement("div",{className:"flex items-start gap-3"},
                React.createElement("div",{className:`text-2xl`},"💡"),
                React.createElement("div",{className:"flex-1"},
                  React.createElement("p",{className:`${darkMode ? 'text-gray-200' : 'text-gray-800'} italic font-medium`},`"${dailyQuote.quote}"`),
                  React.createElement("p",{className:`${darkMode ? 'text-gray-400' : 'text-gray-600'} text-sm mt-1`},`— ${dailyQuote.author}`)
                )
              )
            )
          ),

          React.createElement("div",{className:`${darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white'} rounded-3xl shadow-2xl p-6 md:p-8 mb-6 scale-in`},
            React.createElement("div",{className:"flex items-center justify-between mb-6"},
              // React.createElement("h2",{className:`text-2xl font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`},"New Task"),
              React.createElement("button",{onClick:()=>setShowCategoryModal(true),className:`p-2 rounded-xl transition-all duration-200 ${darkMode ? 'text-gray-400 hover:bg-gray-700 hover:text-teal-400' : 'text-gray-600 hover:bg-gray-100 hover:text-teal-600'}`},
                React.createElement(Settings,{size:20})
              )
            ),

            !showAddTask ? 
              React.createElement("button",{onClick:()=>setShowAddTask(true),className:`w-full py-4 rounded-xl font-medium transition-all duration-300 hover-lift flex items-center justify-center gap-2 ${darkMode ? 'bg-gray-700 border-2 border-gray-600 text-white hover:bg-gray-650' : 'bg-gray-50 border-2 border-gray-200 text-gray-700 hover:bg-gray-100'}`},
                React.createElement(Plus,{size:20}),
                "Create Task"
              ) :
              React.createElement("div",{className:"space-y-4"},
                React.createElement("input",{type:"text",value:text,onChange:e=>setText(e.target.value),onKeyDown:e=>{ if(e.key==='Enter') addTodo(); },placeholder:"What needs to be done?",className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-teal-500' : 'bg-gray-50 border-gray-200 placeholder-gray-400 focus:border-teal-500 focus:bg-white'}`}),
                
                React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},
                  React.createElement("div",null,
                    React.createElement("label",{className:`block text-sm font-semibold ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-2`},"Category"),
                    React.createElement("select",{value:category,onChange:e=>setCategory(e.target.value),className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500'}`},
                      allCategories.map(cat => React.createElement("option",{key:cat,value:cat},cat))
                    )
                  ),
                  React.createElement("div",null,
                    React.createElement("label",{className:`block text-sm font-semibold ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-2`},"Due Date"),
                    React.createElement("input",{type:"date",value:dueDate,onChange:e=>setDueDate(e.target.value),className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500'}`})
                  )
                ),

                React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},
                  React.createElement("div",null,
                    React.createElement("label",{className:`block text-sm font-semibold ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-2`},"Priority"),
                    React.createElement("select",{value:priority,onChange:e=>setPriority(e.target.value),className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500'}`},
                      React.createElement("option",{value:"high"},"High 🔥"),
                      React.createElement("option",{value:"medium"},"Medium ⚡"),
                      React.createElement("option",{value:"low"},"Low ⬇️")
                    )
                  ),
                  React.createElement("div",null,
                    React.createElement("label",{className:`block text-sm font-semibold ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-2`},"Recurrence"),
                    React.createElement("select",{value:recurrence,onChange:e=>setRecurrence(e.target.value),className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500'}`},
                      React.createElement("option",{value:"none"},"None"),
                      React.createElement("option",{value:"daily"},"Daily 🔄"),
                      React.createElement("option",{value:"weekly"},"Weekly 🔄"),
                      React.createElement("option",{value:"monthly"},"Monthly 🔄")
                    )
                  )
                ),

                React.createElement("div",null,
                  React.createElement("label",{className:`block text-sm font-semibold ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-2`},"Notes (Optional)"),
                  React.createElement("textarea",{value:notes,onChange:e=>setNotes(e.target.value),placeholder:"Add any additional details...",rows:3,className:`w-full px-4 py-3 rounded-xl border-2 transition-all duration-200 focus:outline-none resize-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-teal-500' : 'bg-gray-50 border-gray-200 placeholder-gray-400 focus:border-teal-500'}`})
                ),

                React.createElement("div",null,
                  React.createElement("label",{className:`block text-sm font-semibold ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-2`},"Voice Memo (Optional)"),
                  React.createElement("div",{className:"flex flex-col gap-3"},
                    !audioUrl ? 
                      React.createElement("button",{
                        type:"button",
                        onClick: isRecording ? stopRecording : startRecording,
                        className:`w-full py-3 rounded-xl font-medium transition-all duration-300 flex items-center justify-center gap-2 ${isRecording ? 'bg-red-500 hover:bg-red-600 text-white animate-pulse' : darkMode ? 'bg-gray-700 hover:bg-gray-600 text-white border-2 border-gray-600' : 'bg-gray-50 hover:bg-gray-100 text-gray-700 border-2 border-gray-200'}`
                      },
                        React.createElement(Mic,{size:20}),
                        isRecording ? "Stop Recording" : "Record Voice Memo"
                      ) :
                      React.createElement("div",{className:`p-4 rounded-xl ${darkMode ? 'bg-gray-700 border border-gray-600' : 'bg-gray-50 border border-gray-200'}`},
                        React.createElement("div",{className:"flex items-center gap-3 mb-2"},
                          React.createElement(Volume2,{size:20,className:darkMode ? 'text-teal-400' : 'text-teal-600'}),
                          React.createElement("span",{className:`text-sm font-medium ${darkMode ? 'text-gray-300' : 'text-gray-700'}`},"Voice memo recorded")
                        ),
                        React.createElement("audio",{controls:true,src:audioUrl,className:"w-full mb-2"}),
                        React.createElement("button",{
                          type:"button",
                          onClick:clearRecording,
                          className:`text-sm ${darkMode ? 'text-red-400 hover:text-red-300' : 'text-red-600 hover:text-red-700'} transition-colors`
                        },"Remove recording")
                      )
                  )
                ),

                React.createElement("div",{className:"flex gap-3"},
                  React.createElement("button",{onClick:addTodo,className:"flex-1 py-3 rounded-xl font-semibold transition-all duration-300 gradient-bg-teal text-white shadow-lg hover-lift"},
                    "Add Task"
                  ),
                  React.createElement("button",{onClick:()=>setShowAddTask(false),className:`px-6 py-3 rounded-xl font-medium transition-all duration-300 ${darkMode ? 'bg-gray-700 text-white hover:bg-gray-600' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`},
                    "Cancel"
                  )
                )
              )
          ),

          React.createElement("div",{className:`${darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white'} rounded-3xl shadow-2xl p-6 md:p-8 scale-in`},
            React.createElement("div",{className:"mb-6"},
              React.createElement("div",{className:"flex flex-col md:flex-row gap-4 mb-4"},
                React.createElement("div",{className:"flex-1 relative"},
                  React.createElement("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 pointer-events-none"},
                    React.createElement(Search,{size:20,className:darkMode ? 'text-gray-500' : 'text-gray-400'})
                  ),
                  React.createElement("input",{type:"text",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),placeholder:"Search tasks...",className:`w-full pl-12 pr-4 py-3 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-teal-500' : 'bg-gray-50 border-gray-200 placeholder-gray-400 focus:border-teal-500'}`})
                ),
                React.createElement("div",{className:"flex gap-2"},
                  React.createElement("select",{value:selectedCategory,onChange:e=>setSelectedCategory(e.target.value),className:`px-4 py-3 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500'}`},
                    React.createElement("option",{value:"all"},"All Categories"),
                    allCategories.map(cat => React.createElement("option",{key:cat,value:cat},cat))
                  ),
                  React.createElement("select",{value:sortBy,onChange:e=>setSortBy(e.target.value),className:`px-4 py-3 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500'}`},
                    React.createElement("option",{value:"createdAt"},"Sort: Newest"),
                    React.createElement("option",{value:"dueDate"},"Sort: Due Date"),
                    React.createElement("option",{value:"priority"},"Sort: Priority")
                  )
                )
              ),

              React.createElement("div",{className:"flex flex-wrap gap-2"},
                ['all','active','completed'].map(f => 
                  React.createElement("button",{key:f,onClick:()=>setFilter(f),className:`px-4 py-2 rounded-xl font-medium transition-all duration-300 ${filter === f ? 'gradient-bg-teal text-white shadow-md' : darkMode ? 'bg-gray-700 text-gray-300 hover:bg-gray-650' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`},
                    f.charAt(0).toUpperCase() + f.slice(1)
                  )
                ),
                React.createElement("button",{onClick:clearCompletedTasks,className:`ml-auto px-4 py-2 rounded-xl font-medium transition-all duration-300 ${darkMode ? 'bg-red-900/30 text-red-400 hover:bg-red-900/50 border border-red-700' : 'bg-red-50 text-red-600 hover:bg-red-100 border border-red-200'}`},
                  "Clear Completed"
                ),
                React.createElement("button",{onClick:clearAllTasks,className:`px-4 py-2 rounded-xl font-medium transition-all duration-300 ${darkMode ? 'bg-red-900/30 text-red-400 hover:bg-red-900/50 border border-red-700' : 'bg-red-50 text-red-600 hover:bg-red-100 border border-red-200'}`},
                  "Clear All"
                )
              )
            ),

            sortedTodos.filter(t => filter === 'completed' ? t.completed : !t.completed).length === 0 ?
              React.createElement("div",{className:"text-center py-16"},
                React.createElement("div",{className:`text-6xl mb-4`},"📝"),
                React.createElement("p",{className:`text-xl font-medium ${darkMode ? 'text-gray-400' : 'text-gray-500'}`},
                  filter === 'active' ? "No active tasks!" : filter === 'completed' ? "No completed tasks yet" : "No tasks yet. Add one to get started!"
                )
              ) :
              React.createElement("div",{className:"space-y-3"},
                sortedTodos.filter(t => filter === 'completed' ? t.completed : !t.completed).map(todo => {
                  const todoDate = todo.dueDate ? (todo.dueDate.seconds ? new Date(todo.dueDate.seconds * 1000) : new Date(todo.dueDate)) : null;
                  const today = new Date();
                  today.setHours(0,0,0,0);
                  const tomorrow = new Date(today);
                  tomorrow.setDate(tomorrow.getDate() + 1);
                  
                  const overdueTask = todoDate && todoDate < today && !todo.completed;
                  const dueToday = todoDate && todoDate.toDateString() === today.toDateString();
                  const dueTomorrow = todoDate && todoDate.toDateString() === tomorrow.toDateString();

                  return React.createElement("div",{
                    key:todo.id,
                    draggable:true,
                    onDragStart:(e)=>handleDragStart(e, todo.id),
                    onDragOver:(e)=>handleDragOver(e, todo.id),
                    onDragLeave:handleDragLeave,
                    onDrop:(e)=>handleDrop(e, todo.id),
                    onDragEnd:handleDragEnd,
                    className:`${darkMode ? 'bg-gray-700/50 border border-gray-600 hover:bg-gray-700' : 'bg-gray-50 border border-gray-200 hover:bg-white'} rounded-2xl p-5 transition-all duration-200 task-item cursor-move ${draggedId === todo.id ? 'opacity-50 scale-95' : ''} ${dragOverId === todo.id ? 'border-teal-500 border-2 transform scale-102' : ''}`
                  },
                    React.createElement("div",{className:"flex gap-4 items-start"},

                      React.createElement("div",{className:`flex-shrink-0 ${darkMode ? 'text-gray-500' : 'text-gray-400'} cursor-grab active:cursor-grabbing pt-1`},
                        React.createElement(GripVertical,{size:20})
                      ),

                      React.createElement("button",{onClick:()=>toggleTodo(todo.id, todo.completed, todo.recurrence),className:`flex-shrink-0 w-6 h-6 rounded-lg border-2 transition-all duration-200 checkbox-bounce ${todo.completed ? darkMode ? 'bg-teal-600 border-teal-600' : 'bg-teal-500 border-teal-500' : darkMode ? 'border-gray-600 hover:border-teal-500' : 'border-gray-300 hover:border-teal-400'} flex items-center justify-center`},
                        todo.completed && React.createElement(Check,{size:16,className:"text-white"})
                      ),

                      React.createElement("div",{className:"flex-1 min-w-0"},
                        editingId === todo.id ?
                          React.createElement("div",{key:todo.id,className:"space-y-3"},
                            React.createElement("input",{type:"text",value:editText,onChange:e=>setEditText(e.target.value),onKeyDown:e=>{ if(e.key==='Enter') saveEdit(todo.id); if(e.key==='Escape') { setEditingId(null); setEditText(''); setEditNotes(''); setEditCategory(''); setEditDueDate(''); setEditPriority(''); setEditRecurrence(''); } },className:`w-full px-3 py-2 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500'}`}),
                            
                            React.createElement("textarea",{
                              key:`notes-${todo.id}`,
                              defaultValue:editNotes,
                              onChange:e=>setEditNotes(e.target.value),
                              placeholder:"Edit notes...",
                              rows:3,
                              className:`w-full px-3 py-2 rounded-xl border-2 transition-all duration-200 focus:outline-none resize-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-teal-500' : 'bg-gray-50 border-gray-200 placeholder-gray-400 focus:border-teal-500'}`
                            }),
                            
                            // NEW: Category dropdown in edit mode
                            React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},
                              React.createElement("div",null,
                                React.createElement("label",{className:`block text-xs font-semibold ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1`},"Category"),
                                React.createElement("select",{value:editCategory,onChange:e=>setEditCategory(e.target.value),className:`w-full px-3 py-2 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500'}`},
                                  allCategories.map(cat => React.createElement("option",{key:cat,value:cat},cat))
                                )
                              ),
                              // NEW: Due date picker in edit mode
                              React.createElement("div",null,
                                React.createElement("label",{className:`block text-xs font-semibold ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1`},"Due Date"),
                                React.createElement("input",{type:"date",value:editDueDate,onChange:e=>setEditDueDate(e.target.value),className:`w-full px-3 py-2 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500'}`})
                              )
                            ),
                            
                            // NEW: Priority and Recurrence dropdowns in edit mode
                            React.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},
                              React.createElement("div",null,
                                React.createElement("label",{className:`block text-xs font-semibold ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1`},"Priority"),
                                React.createElement("select",{value:editPriority,onChange:e=>setEditPriority(e.target.value),className:`w-full px-3 py-2 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500'}`},
                                  React.createElement("option",{value:"high"},"High 🔥"),
                                  React.createElement("option",{value:"medium"},"Medium ⚡"),
                                  React.createElement("option",{value:"low"},"Low ⬇️")
                                )
                              ),
                              React.createElement("div",null,
                                React.createElement("label",{className:`block text-xs font-semibold ${darkMode ? 'text-gray-400' : 'text-gray-600'} mb-1`},"Recurrence"),
                                React.createElement("select",{value:editRecurrence,onChange:e=>setEditRecurrence(e.target.value),className:`w-full px-3 py-2 rounded-xl border-2 transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white focus:border-teal-500' : 'bg-gray-50 border-gray-200 focus:border-teal-500'}`},
                                  React.createElement("option",{value:"none"},"None"),
                                  React.createElement("option",{value:"daily"},"Daily 🔄"),
                                  React.createElement("option",{value:"weekly"},"Weekly 🔄"),
                                  React.createElement("option",{value:"monthly"},"Monthly 🔄")
                                )
                              )
                            ),
                            
                            React.createElement("div",{className:"flex gap-2"},
                              React.createElement("button",{onClick:()=>saveEdit(todo.id),className:`px-4 py-2 rounded-xl font-medium transition-all duration-300 gradient-bg-teal text-white hover-lift`},"Save"),
                              React.createElement("button",{onClick:()=>{ setEditingId(null); setEditText(''); setEditNotes(''); setEditCategory(''); setEditDueDate(''); setEditPriority(''); setEditRecurrence(''); },className:`px-4 py-2 rounded-xl font-medium transition-all duration-300 ${darkMode ? 'bg-gray-700 text-white hover:bg-gray-600' : 'bg-gray-200 text-gray-700 hover:bg-gray-300'}`},"Cancel")
                            )
                          ) :
                          React.createElement("div",null,
                            React.createElement("div",{className:`text-lg mb-2 ${todo.completed ? 'line-through opacity-60' : ''} ${darkMode ? 'text-white' : 'text-gray-900'}`},todo.text),

                            React.createElement("div",{className:"flex flex-wrap gap-2 mb-2"},
                              todo.priority && React.createElement("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-lg text-xs font-medium ${todo.priority === 'high' ? darkMode ? 'bg-red-900/40 text-red-300 border border-red-700' : 'bg-red-100 text-red-700 border border-red-200' : todo.priority === 'low' ? darkMode ? 'bg-gray-700 text-gray-300 border border-gray-600' : 'bg-gray-100 text-gray-600 border border-gray-200' : darkMode ? 'bg-amber-900/40 text-amber-300 border border-amber-700' : 'bg-amber-100 text-amber-700 border border-amber-200'}`},
                                todo.priority === 'high' ? '🔥' : todo.priority === 'low' ? '⬇️' : '⚡',
                                todo.priority.charAt(0).toUpperCase() + todo.priority.slice(1)
                              ),
                              React.createElement("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-lg text-xs font-medium ${darkMode ? 'bg-purple-900/40 text-purple-300 border border-purple-700' : 'bg-purple-100 text-purple-700 border border-purple-200'}`},
                                React.createElement(Tag,{size:12}),
                                todo.category || 'Other'
                              ),
                              todo.recurrence && todo.recurrence !== 'none' ? React.createElement("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-lg text-xs font-medium ${darkMode ? 'bg-cyan-900/40 text-cyan-300 border border-cyan-700' : 'bg-cyan-100 text-cyan-700 border border-cyan-200'}`},
                                "🔄",
                                todo.recurrence.charAt(0).toUpperCase() + todo.recurrence.slice(1)
                              ) : null,
                              todo.dueDate ? React.createElement("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-lg text-xs font-medium ${ overdueTask ? darkMode ? 'bg-red-900/40 text-red-200 border border-red-700' : 'bg-red-100 text-red-700 border border-red-300' : dueToday ? darkMode ? 'bg-yellow-900/40 text-yellow-200 border border-yellow-700' : 'bg-yellow-100 text-yellow-700 border border-yellow-300' : dueTomorrow ? darkMode ? 'bg-green-900/40 text-green-200 border border-green-700' : 'bg-green-100 text-green-700 border border-green-300' : darkMode ? 'bg-blue-900/40 text-blue-300 border border-blue-700' : 'bg-blue-100 text-blue-700 border border-blue-200' }`},
                                React.createElement(Calendar,{size:12}),
                                (todo.dueDate && todo.dueDate.seconds) ? new Date(todo.dueDate.seconds*1000).toLocaleDateString() : (typeof todo.dueDate === 'string' ? formatDate(todo.dueDate) : String(todo.dueDate)),
                                overdueTask ? ' (Overdue!)' : dueToday ? ' (Today!)' : dueTomorrow ? ' (Tomorrow)' : null
                              ) : null
                            ),

                            todo.notes && React.createElement("div",{className:"mt-3"},
                              React.createElement("button",{onClick:()=>toggleNotes(todo.id),className:`text-xs ${darkMode ? 'text-teal-400 hover:text-teal-300' : 'text-teal-600 hover:text-teal-700'} flex items-center gap-1 font-medium transition-colors`},
                                expandedNotes[todo.id] ? '▼' : '▶',
                                expandedNotes[todo.id] ? 'Hide Notes' : 'Show Notes'
                              ),
                              expandedNotes[todo.id] && React.createElement("div",{className:`mt-2 p-4 rounded-xl ${darkMode ? 'bg-gray-900/50 text-gray-300 border border-gray-700' : 'bg-teal-50/50 text-gray-700 border border-teal-100'} text-sm whitespace-pre-wrap`},
                                todo.notes
                              )
                            ),

                            todo.audioData && React.createElement("div",{className:"mt-3"},
                              React.createElement("div",{className:`p-3 rounded-xl ${darkMode ? 'bg-gray-900/50 border border-gray-700' : 'bg-teal-50/50 border border-teal-100'}`},
                                React.createElement("div",{className:"flex items-center gap-2 mb-2"},
                                  React.createElement(Volume2,{size:16,className:darkMode ? 'text-teal-400' : 'text-teal-600'}),
                                  React.createElement("span",{className:`text-xs font-medium ${darkMode ? 'text-gray-300' : 'text-gray-700'}`},"Voice Memo")
                                ),
                                React.createElement("audio",{controls:true,src:todo.audioData,className:"w-full",style:{height:'32px'}})
                              )
                            )
                          )
                      ),

                      React.createElement("div",{className:"flex items-center gap-2 flex-shrink-0"},
                        React.createElement("button",{
                          // UPDATED: Pass all required parameters to startEdit
                          onClick:()=>startEdit(todo.id, todo.text, todo.notes, todo.category, todo.dueDate, todo.priority, todo.recurrence),
                          className:`p-2 rounded-lg transition-all duration-200 ${darkMode ? 'text-teal-400 hover:bg-gray-700' : 'text-teal-600 hover:bg-teal-50'}`
                        },
                          React.createElement(Edit2,{size:18})
                        ),
                        React.createElement("button",{onClick:()=>deleteTodo(todo.id),className:`p-2 rounded-lg transition-all duration-200 ${darkMode ? 'text-red-400 hover:bg-gray-700' : 'text-red-600 hover:bg-red-50'}`},
                          React.createElement(Trash2,{size:18})
                        )
                      )
                    )
                  );
                })
              )
          ),

          showCategoryModal && React.createElement("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50 fade-in",onClick:()=>setShowCategoryModal(false)},
            React.createElement("div",{className:`${darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white'} rounded-3xl p-8 max-w-md w-full shadow-2xl scale-in`,onClick:e=>e.stopPropagation()},
              React.createElement("div",{className:"flex items-center justify-between mb-6"},
                React.createElement("h3",{className:`text-2xl font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`},"Manage Categories"),
                React.createElement("button",{onClick:()=>setShowCategoryModal(false),className:`p-2 rounded-xl transition-colors ${darkMode ? 'hover:bg-gray-700 text-gray-400' : 'hover:bg-gray-100 text-gray-600'}`},
                  React.createElement(X,{size:24})
                )
              ),

              React.createElement("div",{className:"mb-6"},
                React.createElement("label",{className:`block text-sm font-semibold ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-3`},"Add New Category"),
                React.createElement("div",{className:"flex gap-2"},
                  React.createElement("input",{type:"text",value:newCategory,onChange:e=>setNewCategory(e.target.value),onKeyDown:e=>{ if(e.key==='Enter') addCustomCategory(); },placeholder:"Enter category name...",className:`flex-1 px-4 py-3 border-2 rounded-xl transition-all duration-200 focus:outline-none ${darkMode ? 'bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-teal-500' : 'bg-gray-50 border-gray-200 placeholder-gray-400 focus:border-teal-500'}`}),
                  React.createElement("button",{onClick:addCustomCategory,className:"px-5 py-3 gradient-bg-teal text-white rounded-xl flex items-center gap-2 font-medium hover-lift"},
                    React.createElement(Plus,{size:18}),
                    "Add"
                  )
                )
              ),

              React.createElement("div",{className:"space-y-3"},
                React.createElement("label",{className:`block text-sm font-semibold ${darkMode ? 'text-gray-300' : 'text-gray-700'} mb-3`},"Your Categories"),
                React.createElement("div",{className:"space-y-2 max-h-80 overflow-y-auto pr-2"},
                  defaultCategories.map(cat => 
                    React.createElement("div",{key:cat,className:`flex items-center justify-between p-4 rounded-xl ${darkMode ? 'bg-gray-700/50 border border-gray-600' : 'bg-gray-50 border border-gray-200'}`},
                      React.createElement("span",{className:`font-medium ${darkMode ? 'text-gray-200' : 'text-gray-700'}`},cat),
                      React.createElement("span",{className:`text-xs px-2 py-1 rounded-lg ${darkMode ? 'bg-gray-600 text-gray-400' : 'bg-gray-200 text-gray-500'}`},"Default")
                    )
                  ),
                  customCategories.length === 0 ? 
                    React.createElement("p",{className:`text-sm ${darkMode ? 'text-gray-500' : 'text-gray-400'} italic py-8 text-center`},"No custom categories yet") :
                    customCategories.map(cat => 
                      React.createElement("div",{key:cat,className:`flex items-center justify-between p-4 rounded-xl transition-all ${darkMode ? 'bg-gray-700 hover:bg-gray-650 border border-gray-600' : 'bg-gray-50 hover:bg-gray-100 border border-gray-200'}`},
                        React.createElement("span",{className:`font-medium ${darkMode ? 'text-gray-200' : 'text-gray-700'}`},cat),
                        React.createElement("button",{onClick:()=>deleteCustomCategory(cat),className:`text-red-500 hover:text-red-400 p-2 rounded-lg transition-colors ${darkMode ? 'hover:bg-gray-600' : 'hover:bg-red-50'}`},
                          React.createElement(Trash2,{size:18})
                        )
                      )
                    )
                )
              ),

              React.createElement("div",{className:"mt-8 flex justify-end"},
                React.createElement("button",{onClick:()=>setShowCategoryModal(false),className:`px-6 py-3 rounded-xl font-medium transition-all duration-300 ${darkMode ? 'bg-gray-700 hover:bg-gray-600 text-white' : 'bg-gray-100 hover:bg-gray-200 text-gray-700'} hover-lift`},"Done")
              )
            )
          ),

          showToast && deletedTask && React.createElement("div",{className:"fixed bottom-8 left-1/2 transform -translate-x-1/2 z-50 animate-slide-up"},
            React.createElement("div",{className:`${darkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'} px-6 py-4 rounded-2xl shadow-2xl flex items-center gap-4 min-w-96`},
              React.createElement("div",{className:"flex items-center gap-3 flex-1"},
                React.createElement("div",{className:`p-2 rounded-lg ${darkMode ? 'bg-red-900/30' : 'bg-red-100'}`},
                  React.createElement(Trash2,{size:20,className:darkMode ? 'text-red-400' : 'text-red-600'})
                ),
                React.createElement("div",null,
                  React.createElement("div",{className:`font-semibold ${darkMode ? 'text-white' : 'text-gray-900'}`},"Task deleted"),
                  React.createElement("div",{className:`text-sm ${darkMode ? 'text-gray-400' : 'text-gray-600'} truncate max-w-xs`},deletedTask.text)
                )
              ),
              React.createElement("button",{onClick:undoDelete,className:"px-5 py-2 gradient-bg-teal text-white rounded-xl font-medium transition-all hover-lift"},"Undo")
            )
          ),

          // HELP MODAL: renders above the app when showHelpModal is true
          showHelpModal && React.createElement("div",{className:"fixed inset-0 z-60 flex items-center justify-center help-backdrop p-4", onClick:()=>setShowHelpModal(false)},
            React.createElement("div",{className:`max-w-3xl w-full max-h-[90vh] overflow-y-auto ${darkMode ? 'text-gray-100' : 'text-gray-900'}`, onClick:e=>e.stopPropagation()},
              React.createElement("div",{className:`${darkMode ? 'bg-gray-900 border border-gray-700' : 'bg-white'} rounded-3xl shadow-2xl p-6 md:p-8 scale-in`},
                React.createElement("div",{className:"flex items-start justify-between gap-4 mb-4"},
                  React.createElement("h2",{className:`text-xl md:text-2xl font-bold ${darkMode ? 'text-white' : 'text-gray-900'}`},"Quick guide to getting stuff done!"),
                  React.createElement("button",{onClick:()=>setShowHelpModal(false),className:`p-2 rounded-xl transition-colors flex-shrink-0 ${darkMode ? 'hover:bg-gray-800 text-gray-400 hover:text-white' : 'hover:bg-gray-100 text-gray-600 hover:text-gray-900'}`},
                    React.createElement(X,{size:24})
                  )
                ),

                React.createElement("div",{className:"space-y-4"},
                  React.createElement("p",{className:`${darkMode ? 'text-gray-300' : 'text-gray-700'} text-sm md:text-base`},"Here are a few quick tips to get the most out of TokaTask!"),
                  React.createElement("ul",{className:`list-inside list-disc space-y-2 ${darkMode ? 'text-gray-300' : 'text-gray-700'} text-sm md:text-base`},
                    React.createElement("li",null,"First thing's first! 'Toka' (とか) in Japanese means 'and, etc.'', used to list things in a non-exhaustive way."),
                    React.createElement("li",null,"Add tasks using the Add New Task button - set category, priority, recurrence and due date."),
                    React.createElement("li",null,"Record voice memos for tasks - perfect for quick thoughts or detailed instructions."),
                    React.createElement("li",null,"Drag and drop tasks to reorder them - grab the handle icon on the left side of each task."),
                    React.createElement("li",null,"Toggle completion by clicking the checkbox on a task card. For recurring tasks, a new task will be scheduled when you complete it."),
                    React.createElement("li",null,"Edit tasks including their category, due date, priority, and recurrence using the pencil icon on each card."),
                    React.createElement("li",null,"Delete tasks with the trash icon on each card."),
                    React.createElement("li",null,"Use the search, category filter, and sort options to find and organize tasks quickly."),
                    React.createElement("li",null,"Manage custom categories via the settings (gear) button in the Create Task area."),
                    React.createElement("li",null,"Use Clear Completed or Clear All to bulk remove tasks - these actions are permanent."),
                    React.createElement("li",null,"Toggle dark mode with the sun/moon button icon."),
                    React.createElement("li",null,"TokaTask is a web app. On iPhone (for example), you can open the site on your browser (Safari for example), and choose Add to Home Screen. This will save an icon to your home screen, essentially functioning like an actual app."),
                    React.createElement("li",null,"Additionally, on a desktop browser (Firefox for example), there is an option in the URL bar to Add tab to taskbar. This will save the page to your taskbar at the bottom of your desktop screen for easy access.")
                  ),
                  React.createElement("div",{className:"mt-6 flex justify-end gap-2"},
                    React.createElement("button",{onClick:()=>setShowHelpModal(false),className:`px-5 py-2 rounded-xl font-semibold ${darkMode ? 'bg-gray-800 text-white hover:bg-gray-700' : 'bg-teal-500 text-white hover:bg-teal-600'}`}, "Close")
                  )
                )
              )
            )
          )
        )
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(App));
  </script>
</body>
</html>